<script>
/* yardımcı */
function q(s){return document.querySelector(s);}
function capitalize(s){return s.charAt(0).toUpperCase() + s.slice(1);}

/* Menü aktif buton */
function clearActiveBtns(){
  document.querySelectorAll(".tool-btn").forEach(b=>b.classList.remove("active"));
}

/* Paneli değiştir */
function activate(tool){
  clearActiveBtns();
  const btn = q("#btn" + capitalize(tool));
  if(btn) btn.classList.add("active");
  loadPanel(tool);
}

/* Panel içerik yükleme */
function loadPanel(name){
  const panel = q("#activePanel");

  const panels = {
    calculator: `
      <h2>Hesap Makinesi</h2>
      <div class="calc-screen" id="calcScreen">0</div>
      <div class="calc-keys">
        <div class="key">7</div><div class="key">8</div><div class="key">9</div><div class="key op">/</div>
        <div class="key">4</div><div class="key">5</div><div class="key">6</div><div class="key op">*</div>
        <div class="key">1</div><div class="key">2</div><div class="key">3</div><div class="key op">-</div>
        <div class="key">0</div><div class="key">.</div><div class="key op">C</div><div class="key op">+</div>
        <div class="key op" style="grid-column: span 4">=</div>
      </div>
    `,

    translate: `
      <h2>Çeviri</h2>
      <textarea id="trIn" placeholder="Metni gir..."></textarea>
      <button onclick="doTranslate()">Çevir</button>
      <textarea id="trOut" placeholder="Çeviri burada..." readonly></textarea>
    `,

    summary: `
      <h2>Ödev Özetleyici</h2>
      <textarea id="sumIn" placeholder="Metni buraya yaz..."></textarea>
      <button onclick="doSummary()">Özetle</button>
      <textarea id="sumOut" readonly placeholder="Özet burada..."></textarea>
    `,

    currency: `
      <h2>Para Birimi Dönüştürücü</h2>
      <input id="curAmount" type="number" placeholder="Miktar">
      <select id="curFrom">
        <option value="USD">USD</option>
        <option value="TRY">TRY</option>
        <option value="EUR">EUR</option>
      </select>
      →
      <select id="curTo">
        <option value="TRY">TRY</option>
        <option value="USD">USD</option>
        <option value="EUR">EUR</option>
      </select>
      <button onclick="doCurrency()">Dönüştür</button>
      <input id="curResult" readonly placeholder="Sonuç...">
    `,

    password: `
      <h2>Şifre Oluşturucu</h2>
      <input id="pwLen" type="number" placeholder="Uzunluk (örn 12)">
      <button onclick="genPassword()">Oluştur</button>
      <input id="pwOut" readonly placeholder="Şifre burada...">
    `,

    nick: `
      <h2>Nick Oluşturucu</h2>
      <button onclick="genNick()">Rastgele Nick Oluştur</button>
      <input id="nickOut" readonly placeholder="Nick burada...">
    `,

    clock: `
      <h2>Saat ve Kronometre</h2>
      <div id="liveClock" style="font-size:32px;margin-bottom:14px;"></div>

      <h3>Kronometre</h3>
      <div id="chrono" style="font-size:24px;margin:10px 0;">00:00:00</div>
      <button onclick="startChrono()">Başlat</button>
      <button onclick="stopChrono()">Durdur</button>
      <button onclick="resetChrono()">Sıfırla</button>
    `,
  };

  panel.innerHTML = panels[name] || "<p>Hata: Panel bulunamadı.</p>";
}

/* ————— Araç fonksiyonları ————— */

/* Çeviri */
async function doTranslate(){
  let txt = q("#trIn").value;
  let out = q("#trOut");
  out.value = "Çevriliyor...";
  try{
    let r = await fetch("https://libretranslate.com/translate",{
      method:"POST",
      headers:{ "Content-Type":"application/json" },
      body:JSON.stringify({ q:txt, source:"tr", target:"en" })
    });
    let j = await r.json();
    out.value = j.translatedText;
  }catch(e){
    out.value = "Çeviremedim (basit çeviri): " + txt;
  }
}

/* Özetleyici */
function doSummary(){
  let t = q("#sumIn").value.split(" ");
  q("#sumOut").value = "Kısa Özet: " + t.slice(0,20).join(" ") + "...";
}

/* Döviz */
async function doCurrency(){
  let a = parseFloat(q("#curAmount").value);
  let f = q("#curFrom").value;
  let t = q("#curTo").value;
  let out = q("#curResult");
  out.value = "Hesaplanıyor...";
  try{
    let r = await fetch(`https://api.exchangerate.host/convert?from=${f}&to=${t}&amount=${a}`);
    let j = await r.json();
    out.value = j.result;
  }catch(e){
    out.value = (a * 0.033).toFixed(2);
  }
}

/* Şifre */
function genPassword(){
  let len = parseInt(q("#pwLen").value || 12);
  let chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%&";
  let out = "";
  for(let i=0;i<len;i++) out += chars[Math.floor(Math.random()*chars.length)];
  q("#pwOut").value = out;
}

/* Nick */
function genNick(){
  let parts = ["Shadow","Neon","Razor","Ghost","Nova","Cyber","Vortex","Night","Zero","Phantom"];
  q("#nickOut").value = parts[Math.floor(Math.random()*parts.length)] + Math.floor(Math.random()*999);
}

/* Saat */
setInterval(()=>{
  let d = new Date();
  q("#liveClock").innerText = d.toLocaleTimeString();
},1000);

/* Kronometre */
let c=0,chronoInt=null;
function updateChrono(){
  let h = String(Math.floor(c/3600)).padStart(2,"0");
  let m = String(Math.floor((c%3600)/60)).padStart(2,"0");
  let s = String(c%60).padStart(2,"0");
  q("#chrono").innerText = `${h}:${m}:${s}`;
}
function startChrono(){ if(!chronoInt) chronoInt=setInterval(()=>{c++;updateChrono();},1000); }
function stopChrono(){ clearInterval(chronoInt); chronoInt=null; }
function resetChrono(){ c=0;updateChrono(); }

</script>
